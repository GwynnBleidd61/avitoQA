# Тест-кейсы для API объявлений

## Общие предположения
- Базовый URL сервиса: `https://qa-internship.avito.com` (или иной, заданный через `SERVICE_BASE_URL`).
- Все запросы и ответы используют JSON.
- Поля объявления: `title` (строка), `description` (строка), `price` (целое > 0), `sellerId` (целое в диапазоне 111111–999999), `id` (уникальный идентификатор объявления), `createdAt` (время создания в ISO 8601).
- Статистика по объявлению: `views`, `contacts`, `favorites` — целые значения ≥ 0.
- Эндпоинты:
  - **POST** `/api/1/item` — создание объявления.
  - **GET** `/api/1/item/{id}` — получение объявления по идентификатору.
  - **GET** `/api/1/items?sellerId={sellerId}` — список объявлений продавца.
  - **GET** `/api/1/statistics/{id}` — статистика по объявлению.

## Позитивные кейсы
1. **Создание объявления с валидными данными**
   - **Шаги:** отправить POST `/api/1/item` с корректным телом (все поля заполнены валидно).
   - **Ожидание:** статус 200/201; в ответе присутствует `id`, поля совпадают с запросом, `createdAt` заполнен.

2. **Получение созданного объявления по id**
   - **Шаги:** создать объявление; выполнить GET `/api/1/item/{id}`.
   - **Ожидание:** статус 200; возвращаемые поля совпадают с созданным объявлением.

3. **Список объявлений продавца**
   - **Шаги:** создать 2 объявления для продавца A и 1 для продавца B; вызвать GET `/api/1/items?sellerId={A}`.
   - **Ожидание:** статус 200; список содержит только 2 объявления продавца A; id уникальны; сортировка по `createdAt` (по возрастанию или убыванию — фиксировать в документации).

4. **Статистика существующего объявления**
   - **Шаги:** создать объявление; выполнить GET `/api/1/statistics/{id}`.
   - **Ожидание:** статус 200; `views/contacts/favorites` присутствуют и ≥ 0; `itemId` соответствует id объявления.

5. **Массовое создание объявлений с уникальными sellerId**
   - **Шаги:** отправить несколько POST с разными `sellerId` в допустимом диапазоне.
   - **Ожидание:** статус 200/201 для каждого; id уникальны, пересечений по sellerId нет.

## Негативные кейсы
6. **Отсутствует обязательное поле**
   - **Шаги:** POST `/api/1/item` без `title` (или другого обязательного поля).
   - **Ожидание:** статус 400; сообщение об ошибке с перечислением обязательных полей.

7. **Невалидная цена**
   - **Шаги:** POST `/api/1/item` с `price = -1` или `0`.
   - **Ожидание:** статус 400; текст об ошибке «price must be positive».

8. **Невалидный sellerId**
   - **Шаги:** POST `/api/1/item` с `sellerId` вне диапазона 111111–999999 или строкой.
   - **Ожидание:** статус 400; описание ограничения диапазона/типа.

9. **Запрос несуществующего объявления**
   - **Шаги:** GET `/api/1/item/{fakeId}`.
   - **Ожидание:** статус 404; сообщение «item not found».

10. **Статистика для несуществующего объявления**
    - **Шаги:** GET `/api/1/statistics/{fakeId}`.
    - **Ожидание:** статус 404; ошибка «stats not found» или аналогичная.

11. **Неверный формат sellerId в запросе списка**
    - **Шаги:** GET `/api/1/items?sellerId=abc`.
    - **Ожидание:** статус 400; сообщение о неверном формате query-параметра.

12. **Слишком длинный title/description**
    - **Шаги:** POST `/api/1/item` с длиной полей больше лимита (например > 255 символов для title).
    - **Ожидание:** статус 400; сообщение об ограничении длины.

13. **Некорректный Content-Type**
    - **Шаги:** POST `/api/1/item` с `Content-Type: text/plain` и JSON-телом.
    - **Ожидание:** статус 415 или 400; сообщение о неподдерживаемом типе.

14. **SQL/скриптовая инъекция в текстовых полях**
    - **Шаги:** POST `/api/1/item` с `title` вида `"<script>alert(1)</script>"`.
    - **Ожидание:** статус 200/201; тело экранировано или сохранено как текст без исполнения; при последующем GET содержимое не модифицировано.

15. **Повторное использование id (если API позволяет внешнее задание id)**
    - **Шаги:** создать объявление; попытаться создать ещё одно с тем же id (если есть такой параметр) либо отправить дубликат запроса.
    - **Ожидание:** при дубликате запросов — либо идемпотентность (одно объявление), либо 409 Conflict при явном указании id.

## Нефункциональные проверки (ручные/дополнительные)
- **Скорость ответа**: время ответа не превышает SLA (например, 500 мс для GET).
- **Нагрузочная устойчивость**: параллельное создание/чтение объявлений без деградации.
- **Безопасность**: отсутствуют открытые CORS для чужих источников, корректная валидация входных данных.
